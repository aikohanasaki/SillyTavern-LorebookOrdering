[連結至 ST 記憶書 (STMB)](https://github.com/aikohanasaki/SillyTavern-MemoryBooks) | [連結至 ST 知識庫排序 (STLO)](https://github.com/aikohanasaki/SillyTavern-LorebookOrdering)

# 🧠 終極記憶指南：STMB + STLO

ST 記憶書 (STMB) 對於**生成記憶內容**至關重要，而 ST 知識庫排序 (STLO) 則對於**確保這些內容被 AI 實際使用**至關重要。當兩者結合使用時，它們解決了**記憶排斥**的核心問題。

## 步驟 1：奠定基礎 (The Foundation)

**強制「均勻排序」：** 您必須首先確保 SillyTavern 的預設世界資訊 (WI) 設定已配置為允許 STLO 接管。在您的 SillyTavern **世界資訊設定**中，將**世界資訊插入策略**設定為**「均勻排序」**。STLO 需要此策略來繞過 SillyTavern 基礎程式碼中僵化的類別排序（聊天 $\rightarrow$ 角色卡 $\rightarrow$ 等）。

## 步驟 2：建立記憶內容 (STMB 的工作)

使用 STMB 自動建立您的長期記憶。

1.  **啟用自動摘要：** 前往 STMB 面板（魔術棒 🪄）並開啟**自動摘要**。設定您偏好的間隔（例如，**30 則訊息**）。
2.  **綁定/建立記憶書：** 確保您的聊天有一個專門用於記憶的知識庫。STMB 通常會將記憶放置在全域類型的書中，但為了簡單起見，通常會使用與聊天綁定的知識庫。
3.  **正常聊天：** 隨著聊天的進行，STMB 會自動產生密集、高品質、結構化的摘要。這些記憶現在就像是試圖登上 AI 有限上下文「航班」的「乘客」。

## 步驟 3：保證優先級 (STLO 的工作)

這是最關鍵的一步。您必須使用 STLO 手動降低**與聊天綁定的 STMB 書**的優先級，同時提升您的**角色核心設定**。

### A. 打破「聊天優先」的陷阱
預設情況下，與聊天綁定的記憶書被賦予**最高優先級**（聊天優先），這有可能使其佔用過多的上下文空間，並排斥其他世界、角色和/或角色卡知識庫。STLO 允許您透過重新分配一個自訂的、特定的優先級來解決這個問題。

### B. 推薦的優先級堆疊

使用 STLO 為所有相關的知識庫設定自訂優先級：

| 知識庫/記憶 | 自訂 STLO 優先級 | 為什麼？ (堆疊) |
| :--- | :--- | :--- |
| **角色核心設定** (性格, 描述) | **優先級 5** (最高) | **最先載入**，以在載入任何其他內容之前鎖定核心角色身份和語調。 |
| **STMB 記憶書** (您的記憶) | **優先級 4** (高) | **第二載入**。足夠高以確保記憶被包含，但又足夠低以保證核心設定首先載入。 |
| **角色卡知識庫** (您的身份) | **優先級 3** (預設/普通) | **第三載入**。在角色的核心設定和關鍵記憶之後看到使用者資訊。 |
| **通用/隨機知識庫** (事件記憶, 世界知識) | **優先級 1-2** (最低) | **最後載入**。不太重要的資訊只有在還有剩餘空間時才會被包含。 |

### C. 設定預算上限
對於 STMB 記憶書（以及任何其他密集的知識庫），使用 STLO 的**預算**功能來防止其消耗所有空間，即使優先級很高。

1.  開啟您的 STMB 知識庫的 STLO 設定。
2.  設定一個**預算**上限（例如，**固定權杖數**如 `5000`，或**上下文百分比**如 `15%`）。
3.  這可以保證即使知識庫被提前處理，它也會**自動修剪**以遵守您的容量上限，為所有其他優先級為 3、2 和 1 的知識庫留出空間。
